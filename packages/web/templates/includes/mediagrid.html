{% for group in media_groups -%}
  <section>
    <div class="p-2 position-sticky top-0 mediagroup">
      <h2 class="p-0 m-0 fw-normal">{{group.title}}</h2>
    </div>
    <ui-thumbnailgrid>
      {%- for media in group.media %}
        <ui-thumbnail rating="{{media.rating|default("")}}" href="{{base}}/media/{{media.id}}">
          {%- match media.file %}
            {%- when Some with (file) -%}
              <picture>
                {%- for type in thumbnails.alternate_types %}
                  <source
                    sizes="150px"
                    srcset="
                      {%- for size in thumbnails.sizes -%}
                        /media/{{media.id}}/{{file.id}}/thumb/{{size}}/image-webp/{{media.filename|default("unknown")|strip_extension}}.{{type|mime_extension}} {{size}}w,
                      {%- endfor -%}
                    "
                    type="{{type}}">
                  </source>
                {%- endfor %}
                <img
                  loading="lazy"
                  decoding="async"
                  sizes="150px"
                  srcset="
                    {%- for size in thumbnails.sizes -%}
                      /media/{{media.id}}/{{file.id}}/thumb/{{size}}/image-jpeg/{{media.filename|default("unknown")|strip_extension}}.jpg {{size}}w,
                    {%- endfor -%}
                  "
                  class="d-block object-fit-contain"
                  style="width: 100%; aspect-ratio: 1; object-position: center center"
                >
              </picture>
            {%- else -%}
          {%- endmatch %}
        </ui-thumbnail>
      {%- endfor %}
    </ui-thumbnailgrid>
  </section>
{%- endfor %}

{% for group in media_groups -%}
  <section class="pb-3">
    <h2 class="pb-2 m-0 fw-normal">{{group.title}}</h2>
    <ui-thumbnailgrid>
      {%- for media in group.media %}
        <ui-thumbnail href="{{base}}/media/{{media.id}}">
          {%- match media.file %}
            {%- when Some with (file) -%}
              <picture>
                {%- for type in thumbnails.alternate_types %}
                  <source
                    sizes="150px"
                    srcset="
                      {%- for size in thumbnails.sizes -%}
                        /media/{{media.id}}/{{file.id}}/thumb/{{size}}/image-webp/{{media.filename|default("unknown")|strip_extension}}.{{type|mime_extension}} {{size}}w,
                      {%- endfor -%}
                    "
                    type="{{type}}">
                  </source>
                {%- endfor %}
                <img
                  loading="lazy"
                  decoding="async"
                  sizes="150px"
                  srcset="
                    {%- for size in thumbnails.sizes -%}
                      /media/{{media.id}}/{{file.id}}/thumb/{{size}}/image-jpeg/{{media.filename|default("unknown")|strip_extension}}.jpg {{size}}w,
                    {%- endfor -%}
                  "
                  class="d-block object-fit-contain"
                  style="width: 150px; height: 150px; object-position: center center"
                >
              </picture>
            {%- else -%}
          {%- endmatch %}
        </ui-thumbnail>
      {%- endfor %}
    </ui-thumbnailgrid>
  </section>
{%- endfor %}
